name: tests

on: push

jobs:
  lint:
    name: Run tests
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: install poetry
        run: pip install poetry

      - name: set up poetry
        run: make install

      - name: Run tests
        run: make test
        
      - name: gen coverage report
      - uses: paambaati/codeclimate-action@v2.7.5
          env:
            CC_TEST_REPORTER_ID: ba6c8d125464897f8634036aaa01fc0caf77e3b9b1270c4a25875dfe2c3b1b24
          with:
            coverageCommand: make coverage
      - name: delete coverage report
        run: rm coverage.xml
